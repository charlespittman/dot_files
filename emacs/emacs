;; Use a separate file for customizations made through Customize
(setq custom-file "~/.emacs.d/custom.el")
(load custom-file)

;; Turn off mouse interface early in startup to avoid momentary display
(when (fboundp 'tool-bar-mode) (tool-bar-mode -1))
(when (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))

(setq inhibit-startup-screen t)

;; Set repos for package manager
(require 'package)
(setq package-archives '(("gnu" . "http://elpa.gnu.org/packages/")
                         ("marmalade" . "http://marmalade-repo.org/packages/")
                         ("melpa" . "http://melpa.milkbox.net/packages/")))
(package-initialize)
(unless (package-installed-p 'package+)
  (package-install 'package+))

(package-manifest 'auto-complete 'bind-key
                  'color-theme-sanityinc-solarized
                  'color-theme-sanityinc-tomorrow 'confluence
                  'clues-theme 'diminish 'distinguished-theme
                  'elpy 'expand-region 'flycheck
                  'flycheck-color-mode-line 'flycheck-haskell
                  'flycheck-pos-tip 'ghc 'ghci-completion
                  'gruvbox-theme 'haskell-mode 'jira 'magit
                  'org-ac 'org-bullets 'org-jira 'package+
                  'python 'rubocop 'ruby-mode 'smart-tabs-mode
                  'sudo-ext 'tuareg 'use-package 'w3m
                  'writegood-mode 'yasnippet)

;;(require 'site-gentoo)

;; Turn on syntax highlighting globally
(global-font-lock-mode t)

;; Shorten confirmation prompts
(defalias 'yes-or-no-p 'y-or-n-p)

;; Don't make *.~ files
(setq make-backup-files nil)

(show-paren-mode t)
(eldoc-mode t)

;; Removing trailing whitespace every time a file is saved.
(add-hook 'before-save-hook 'delete-trailing-whitespace)

;; No tabs.  Just use spaces.
(setq-default indent-tabs-mode nil)

;; make typing overwrite text selection
(delete-selection-mode t)

;; turn on automatic bracket insertion by pairs.
;;(electric-pair-mode t)

(global-visual-line-mode t)

(setq make-backup-files nil) ; stop creating those backup~ files
(setq auto-save-default nil) ; stop creating those #auto-save# files

(require 'use-package)


(use-package w3m
  :init (setq w3m-mode-map (make-sparse-keymap))
  :config (progn
            (require 'w3m-haddock)
            (add-hook 'w3m-display-hook 'w3m-haddock-display)
            (define-key haskell-mode-map (kbd "C-c C-d") 'haskell-w3m-open-haddock)
            (define-key w3m-mode-map (kbd "RET") 'w3m-view-this-url)
            (define-key w3m-mode-map (kbd "q") 'bury-buffer)
            (define-key w3m-mode-map (kbd "<mouse-1>") 'w3m-maybe-url)
            (define-key w3m-mode-map [f5] 'w3m-reload-this-page)
            (define-key w3m-mode-map (kbd "C-c C-d") 'haskell-w3m-open-haddock)
            (define-key w3m-mode-map (kbd "M-<left>") 'w3m-view-previous-page)
            (define-key w3m-mode-map (kbd "M-<right>") 'w3m-view-next-page)
            (define-key w3m-mode-map (kbd "M-.") 'w3m-haddock-find-tag)

            (defun w3m-maybe-url ()
              (interactive)
              (if (or (equal '(w3m-anchor) (get-text-property (point) 'face))
                      (equal '(w3m-arrived-anchor) (get-text-property (point) 'face)))
                  (w3m-view-this-url)))))

;; Start mail-mode for any file with 'mutt' in the name.
(add-to-list 'auto-mode-alist '("/mutt" . mail-mode))

(add-to-list 'auto-mode-alist '("\\zsh\\'" . shell-script-mode))

(add-to-list 'load-path "~/.emacs.d/elisp/")
(load-library "keys")
(load-library "conf-haskell")
(load-library "conf-org")
(load-library "conf-python")
(load-library "conf-quicklisp")
(load-library "conf-tuareg")
